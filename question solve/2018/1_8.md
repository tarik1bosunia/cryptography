# Cryptography — Full Exam Answers

## Section–A

### 1.

**(a)** Ciphertext, Encryption, Cryptography, Cryptologist

* **Ciphertext:** The encrypted form of plaintext; unreadable without decryption. Example: `HELLO` → `KHOOR` (Caesar cipher).
* **Encryption:** Process of converting plaintext into ciphertext using a key. Ensures confidentiality.
* **Cryptography:** The science of designing secure communication systems using mathematics and algorithms.
* **Cryptologist:** A professional who studies or applies cryptography and cryptanalysis techniques.

**(b)** Drawbacks of Restricted Algorithm

* Security depends on secrecy of algorithm, not the key.
* Once the algorithm leaks, the system fails completely.
* Difficult to manage large systems with many users.

**(c)** One-time Pad (OTP)

* Each bit/character of plaintext is combined with a truly random key of same length.
* Encryption: `C = P ⊕ K`, Decryption: `P = C ⊕ K`.
* **Example:** `HELLO` XOR random key → random ciphertext.
* **Advantage:** Perfect secrecy (unbreakable). **Drawback:** Key must be as long as the message and never reused.

---

### 2.

**(a)** Hybrid Cryptography Communication

* Combines **symmetric** and **asymmetric** cryptography for efficiency and security.

1. Asymmetric key (e.g., RSA) used to exchange a symmetric session key.
2. Symmetric cipher (e.g., AES) encrypts actual data.

* Example: HTTPS uses RSA + AES.

**(b)** Timestamps

* Used to mark message generation time.
* Prevent replay attacks by ensuring freshness.
* Example: In Kerberos, timestamps validate session authenticity.

**(c)** Time & Cost Estimate for Brute-force Attack

* If a cipher uses `n`-bit keys → keyspace = 2ⁿ.
* Average attempts needed = 2ⁿ⁻¹.
* Example: For 56-bit DES, ≈ 7×10¹⁶ trials required.

---

### 3.

**(a)** Key Space & Reduced Key Space

* **Key Space:** Total number of possible keys. For n-bit key, keyspace = 2ⁿ.
* **Reduced key space:** Smaller set due to poor design or weak randomness.
* **Effect:** Makes brute-force easier; weakens overall security.

**(b)** Define

* **Key Crunching:** Reducing key input to fixed size for cipher operations.
* **GCD:** Greatest number dividing two integers (e.g., GCD(8,12)=4).
* **Inverse Modulo:** Number x such that `(a×x) ≡ 1 (mod m)`.

**(c)** Database of all primes & Public Key

* Even with a list of primes, public key security remains strong because breaking RSA requires factoring large composite numbers (product of two unknown primes), not just finding primes.

---

### 4.

**(a)** Lehmann’s Prime Number Test Algorithm

1. Choose random `a` (2 ≤ a ≤ n−1).
2. Compute `a^{(n−1)/2} mod n`.
3. If result ≠ ±1, n is composite.
4. Repeat with different a’s for higher confidence.

**(b)** DES Initial and Final Permutation

* **Initial Permutation (IP):** Rearranges 64-bit plaintext before processing.
* **Final Permutation (FP):** Inverse of IP, applied after 16 rounds.
* Example: If IP shifts bit 1 → position 58, FP reverses this.

**(c)** Triple-DES (3DES)

* Applies DES three times with multiple keys.
* Modes: Encrypt–Decrypt–Encrypt (EDE).
  `C = E_{K3}(D_{K2}(E_{K1}(P)))`
* Increases security and key length (112–168 bits).

---

## Section–B

### 5.

**(a)** Design Goals of MD4

* Efficiency in software.
* Simple operations (XOR, addition, rotation).
* Collision resistance (though later broken).

**(b)** Secure Hash Algorithm (SHA)

* Produces 160–512-bit digest (SHA-1, SHA-2, SHA-3).
* Resistant to collisions and preimage attacks.
* Used in signatures, certificates, blockchain.

**(c)** RSA Example

1. Choose p=5, q=7 ⇒ n=35, φ(n)=24.
2. Choose e=11, find d s.t. 11d ≡1(mod 24) → d=11.
3. Encrypt M=12 → C=12¹¹ mod35=17.
4. Decrypt C=17¹¹ mod35=12 ✅.

---

### 6.

**(a)** What is Kerberos?
A symmetric-key authentication protocol providing secure client-server access over networks using tickets and timestamps.

**(b)** Message Format in V4 and V5

| Field             | V4      | V5                           |
| ----------------- | ------- | ---------------------------- |
| Encryption        | DES     | AES/3DES                     |
| Ticket Validity   | Fixed   | Time-stamped                 |
| Cross-realm       | Limited | Supported                    |
| Encryption Type   | Single  | Multiple                     |
| Replay Prevention | None    | Authenticator with timestamp |

**(c)** Diffie-Hellman Key Exchange

* Shared secret K = (α^{Xa})^{Xb} mod q = (α^{Xb})^{Xa} mod q.
* Example: q=353, α=3, Xa=97, Xb=233 ⇒ K=160.

---

### 7.

**(a)** Why is PGP widely used?

* Combines symmetric & public-key encryption.
* Ensures confidentiality, integrity, authentication.
* Widely used for secure emails & files.

**(b)** PGP Confidentiality & Authentication (Diagram)

```
Message → Hash → Signature(SK_sender)
        → Encrypt with Session Key (Ks)
        → Ks encrypted with Receiver’s Public Key
Send: [Encrypted Msg + Encrypted Ks]
Receiver: Decrypt Ks → Decrypt Msg → Verify Signature
```

**(c)** Types of Intruders

* **Masquerader:** External attacker impersonating a user.
* **Misfeasor:** Legitimate user misusing access.
* **Clandestine user:** Gains admin rights & hides activity.

---

### 8.

**(a)** Trap Door, Logic Bomb, Trojan Horse

* **Trap Door:** Hidden access in software for maintenance; exploitable by attackers.
* **Logic Bomb:** Malicious code triggered by condition/event.
* **Trojan Horse:** Program that performs malicious actions disguised as normal software.

**(b)** Virus & Its Lifetime

* **Virus:** Self-replicating code attaching to programs/files.
* **Lifetime:** Creation → Infection → Trigger → Execution → Detection/Removal.

**(c)** Firewall Design Goals & Limitations

* **Goals:** Monitor, filter, and log network traffic to enforce policies.
* **Limitations:** Can’t stop insider threats, or attacks via allowed ports (e.g., encrypted malware traffic).

**Example:** Application-level firewalls inspect HTTP traffic; packet filters cannot detect SQL injection attacks hidden in HTTP requests.
