## Question 3 Answers (Set 2)

### (a) Define prime numbers, primitive root of a prime number, and inverse modulo a number

**Prime number:** A natural number greater than 1 that has no positive divisors other than 1 and itself (e.g., 2, 3, 5, 7, …).

**Primitive root of a prime p:** An integer **g** such that the powers of g generate all non‑zero residues mod p. Formally, g is a primitive root mod p if the smallest k with `g^k ≡ 1 (mod p)` is **k = p−1**. Then `{g^1, g^2, …, g^{p−1}} ≡ {1,2,…,p−1} (mod p)` in some order.

**Inverse modulo n:** For an integer **a**, a **multiplicative inverse modulo n** is an integer **a⁻¹** such that `a·a⁻¹ ≡ 1 (mod n)`. It exists **iff** `gcd(a, n) = 1`. It can be found by the **Extended Euclidean Algorithm**.

*Example:* Inverse of 7 mod 26 is 15 because `7×15 = 105 ≡ 1 (mod 26)`.

---

### (b) DES has 16 identical rounds — briefly discuss the operations in a round

DES uses a **Feistel structure**. Let the input to round r be `L_{r−1}` and `R_{r−1}` (each 32 bits) and the subkey be `K_r` (48 bits). One round performs:

1. **Expansion (E):** Expand `R_{r−1}` from 32 → 48 bits using the fixed E‑table (duplicating border bits within each 4‑bit nibble).
2. **Key mixing:** XOR the expanded block with the 48‑bit subkey: `B = E(R_{r−1}) ⊕ K_r`.
3. **Substitution (S‑boxes):** Split B into eight 6‑bit chunks. Each chunk goes through an S‑box (S1…S8) giving **8×4 = 32 bits**.
4. **Permutation (P‑box):** Permute these 32 bits via the fixed P table to diffuse bit positions.
5. **Feistel combine:** `L_r = R_{r−1}` and `R_r = L_{r−1} ⊕ P(S(B))`.

After 16 rounds, a final swap and the inverse initial permutation (IP⁻¹) produce the ciphertext.

---

### (c) Expansion permutation output (32 → 48 bits)

**Given 32‑bit input:** `1010 0101 1100 0011 1001 1001 0111 0111`
Remove spaces: `10100101110000111001100101110111` (bits 1…32).

**DES E‑table mapping (output bit positions):**
`[32,1,2,3,4,5, 4,5,6,7,8,9, 8,9,10,11,12,13, 12,13,14,15,16,17, 16,17,18,19,20,21, 20,21,22,23,24,25, 24,25,26,27,28,29, 28,29,30,31,32,1]`

**Computed 48‑bit output:**
`110100001011111000000111110011110010101110101111`

Grouped into 8 chunks of 6 (for S‑boxes):
`110100 001011 111000 000111 110011 110010 101110 101111`

(So the equivalent 48‑bit expanded value is exactly the above bitstring.)
