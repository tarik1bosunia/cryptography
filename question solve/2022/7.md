# Cryptography Question 7 Solutions

---

## 7(a) Compare Message Digest (MD5) and Secure Hash Algorithm (SHA)

| Aspect                     | **MD5**                                                  | **SHA‑1**                                                       | **SHA‑2 (SHA‑256/384/512)**                        | **SHA‑3 (Keccak)**                       |
| -------------------------- | -------------------------------------------------------- | --------------------------------------------------------------- | -------------------------------------------------- | ---------------------------------------- |
| Output length              | 128 bits                                                 | 160 bits                                                        | 256/384/512 bits                                   | 224/256/384/512 bits                     |
| Design family              | MDx (Merkle–Damgård)                                     | Merkle–Damgård                                                  | Merkle–Damgård                                     | Sponge construction                      |
| Speed                      | Very fast                                                | Fast                                                            | Fast (slower than MD5/SHA‑1)                       | Competitive                              |
| Collision resistance today | **Broken** (practical, chosen‑prefix collisions trivial) | **Broken** (2017 SHAttered; chosen‑prefix collisions practical) | **Strong** (no practical collisions known)         | **Strong**                               |
| Preimage resistance        | No practical preimages known, but confidence is **low**  | No practical preimages known; confidence **low**                | Considered strong at recommended sizes             | Strong                                   |
| Current use                | Avoid for security; okay only for non‑security checksums | Avoid                                                           | Preferred for security (e.g., SHA‑256)             | Alternate modern choice                  |
| Typical uses (today)       | Legacy checksum, deduplication (non‑adversarial)         | Legacy verification where authenticity not required             | TLS, code signing, digital signatures, blockchains | Some modern protocols, FIPS‑202 contexts |

**Bottom line:** Use **SHA‑256 or stronger** (or **SHA‑3**). Do **not** use MD5 or SHA‑1 for any security‑relevant purpose.

---

## 7(b) What is a firewall? Explain its limitations

**Firewall:** a network security device/software that enforces a policy on traffic crossing security boundaries. It filters packets/flows based on rules (IP/port/protocol, state), and in next‑gen forms can also inspect applications and content.

**Core types**

* **Packet‑filter / stateless**
* **Stateful inspection**
* **Application/Proxy (Layer‑7)**
* **Next‑Gen Firewall (NGFW)** with IDS/IPS features

**What firewalls do well**

* Segment networks and enforce least‑privilege connectivity
* Block unsolicited inbound traffic and obvious scans/exploits

**Limitations**

1. **Encrypted traffic blind spot:** Without TLS interception, payloads are opaque; malware/phishing can pass inside HTTPS.
2. **Insider/compromised host threats:** Traffic already inside the perimeter may bypass controls.
3. **Application‑layer logic bugs:** A simple firewall cannot fix vulnerable apps, weak auth, SQLi/XSS, etc. (needs WAF/secure coding).
4. **Misconfiguration complexity:** Large rule sets become error‑prone, leading to accidental exposure.
5. **Evasion/tunneling:** Attackers can tunnel over allowed ports (e.g., DNS/HTTPS) or use covert channels.
6. **Mobile/remote users:** Devices off‑network bypass on‑prem firewalls unless VPN/Zero‑Trust is used.
7. **Zero‑day/unknown threats:** Signature‑based IPS components may miss novel attacks.
8. **Performance/MTU overhead:** Deep inspection and VPN features add latency and can break PMTUD if not tuned.

> **Takeaway:** Firewalls are necessary but not sufficient—pair with endpoint security, identity, patching, segmentation, and monitoring.

---

## 7(c) What is IP security? Role of **IPsec** in the routing architecture

**IP security (general):** measures that provide confidentiality, integrity, and authentication for IP traffic. The principal standard is **IPsec** (suite including AH/ESP and IKE/IKEv2) operating at the network layer.

### How IPsec fits into routing architectures

* **Site‑to‑Site VPN (tunnel mode):** Routers/firewalls build IPsec tunnels across untrusted networks. Interior routing protocols (e.g., OSPF/BGP over GRE or directly over tunnel interfaces) run **inside** the encrypted tunnel, extending a secure routed domain.
* **Protecting routing adjacencies:**

  * **OSPFv3**: specifies IPsec ESP/AH for authenticating and optionally encrypting control packets.
  * **OSPFv2/IS‑IS**: often use per‑packet authentication (MD5/TLVs); can be carried inside IPsec tunnels for confidentiality.
  * **BGP**: commonly uses TCP‑AO or MD5 for session auth; if confidentiality or path‑hiding is needed, run BGP over IPsec/GRE tunnels between peers.
* **Host‑to‑Host transport mode:** Protects server↔server links without changing applications; routing remains unchanged, but packets carry ESP/AH headers.
* **NAT traversal (NAT‑T):** Encapsulates ESP in UDP/4500 to cross NATs—important for Internet‑routed topologies.
* **Scalability with IKEv2:** Automates peer authentication (pre‑shared keys or certificates), negotiates ciphers, and rekeys Security Associations (SAs), which is essential for large, dynamic routed networks.

**Operational considerations**

* MTU/MSS tuning due to ESP overhead; use PMTUD or adjust MSS to avoid fragmentation.
* Crypto policy (cipher suites, lifetimes) should align across domains.
* High availability: use redundant tunnels and dynamic routing over them to converge around failures.

**Summary:** IPsec secures IP at layer‑3. In routed designs it (1) forms encrypted tunnels that carry interior routing, and (2) authenticates/optionally encrypts routing control traffic itself, strengthening the overall routing infrastructure.
