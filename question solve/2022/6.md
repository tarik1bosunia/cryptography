# Cryptography Question 6 Solutions

---

## 6(a) What is PGP?

**Pretty Good Privacy (PGP)** is a *hybrid* cryptosystem for securing e‑mail/files. It combines:

* **Public‑key crypto** to protect a one‑time **session key** (key transport)
* **Symmetric crypto** (fast) to encrypt the bulk message with that session key
* **Hashing + digital signatures** for integrity, authentication, and non‑repudiation
* **Compression** (ZIP) before encryption and **Radix‑64 (ASCII armor)** after encryption for e‑mail friendliness
* **Key rings** and a **web‑of‑trust** model (users sign each other’s keys) instead of a strict X.509 hierarchy

Why hybrid? Public‑key alone is slow for large data; symmetric alone cannot distribute keys securely. PGP gets the best of both.

---

## 6(b) How PGP provides **confidentiality + authentication** (with neat diagrams)

Below is the **standard PGP sending pipeline** when you want *both* confidentiality and authentication.

### Sender side (Alice → Bob)

```
Message m
  │
  ├─(1) Hash m  ───────────▶  h = Hash(m)
  │                           (e.g., SHA‑256)
  │
  ├─(2) Sign h with Alice's private key  ─▶  Sig = Sign_SK_A(h)
  │
  ├─(3) Attach signature to message  ────▶  (m, Sig)
  │
  ├─(4) Compress                        ───▶  C = Compress(m, Sig)
  │
  ├─(5) Generate random session key Ks  ───▶  Ks
  │
  ├─(6) Symmetric‑encrypt C with Ks     ───▶  E = Enc_sym(Ks, C)
  │
  └─(7) Public‑key encrypt Ks for Bob   ───▶  EK = Enc_PK_B(Ks)
                                          
Final PGP message = [ EK || E ]
(Optionally ASCII‑armored for e‑mail transfer)
```

**What each step achieves**

* (1)+(2) **Authentication & Integrity**: only Alice can create `Sig`; any change in `m` breaks verification.
* (6) **Confidentiality** of content: encrypted with fast symmetric cipher (e.g., AES).
* (7) **Secure key transport**: only Bob (with his private key) can recover `Ks`.

### Receiver side (Bob)

```
[ EK || E ]
  │
  ├─(1) Decrypt session key:  Ks = Dec_SK_B(EK)
  │
  ├─(2) Symmetric‑decrypt:    C = Dec_sym(Ks, E)
  │
  ├─(3) Decompress:          (m, Sig)
  │
  ├─(4) Recompute h' = Hash(m)
  │
  └─(5) Verify signature with Alice's public key:
         Verify_PK_A(Sig, h')  ⇒  accept/reject
```

If verification passes, Bob is assured the message is from Alice and unmodified, and he has the plaintext `m`.

### Variants

* **Confidentiality only:** Skip steps (1)-(3); just encrypt with `Ks` and wrap `Ks` with Bob’s public key.
* **Authentication only (clear‑sign):** Sign the hash and send `(m, Sig)` without encryption.

---

## 6(c) What are the applications of IPsec?

**IPsec** secures IP traffic at the network layer using **AH** (authentication) and **ESP** (encryption/auth+encap), with **IKE/IKEv2** for key management. It supports **transport mode** (host↔host) and **tunnel mode** (gateway↔gateway/host). Real‑world uses include:

1. **Site‑to‑Site VPNs (Tunnel Mode):** Securely connect branch offices/data centers over the Internet.
2. **Remote‑Access VPNs:** Employees connect laptops/phones to the corporate network securely.
3. **Cloud/Hybrid Connectivity:** Encrypt links between on‑prem routers and cloud VPC/VNET gateways.
4. **Host‑to‑Host Protection (Transport Mode):** Secure server‑to‑server traffic (e.g., DB ↔ app) without changing applications.
5. **BYOD / MDM Enforcement:** Device compliance with always‑on IPsec profiles.
6. **IPv6 Security Baseline:** Native compatibility (IPsec is mandatory in IPv6 stack specs).
7. **Routing Security:** Protects dynamic routing protocol sessions (e.g., OSPFv3 with IPsec ESP/AH).
8. **VoIP and Real‑time Streams:** IPsec ESP with NAT‑T to traverse NATs while protecting SIP/RTP.
9. **Industrial/IoT Links:** Gateway tunnels to shield PLCs/sensors across untrusted networks.

**Key points to remember**

* **ESP** provides confidentiality + integrity (most common). **AH** provides integrity only.
* **Tunnel mode** wraps the entire IP packet; **transport mode** protects just the payload.
* **IKEv2** negotiates ciphers, authenticates peers (pre‑shared keys, certificates), and handles rekeying.
