# Cryptography Question 3 Solutions

---

## Q3(a) If someone creates a database of all primes, won’t he be able to use that database to break public key?

**Explanation:**

* Public key cryptosystems (like RSA) rely on the difficulty of **prime factorization** of very large numbers (e.g., 2048-bit integers).
* The modulus $n$ in RSA is a product of two very large primes ($p$ and $q$).
* To break RSA, one would need to factorize $n$ into $p$ and $q$.

**Why database of all primes won’t work:**

1. **Size of primes**: For a 2048-bit key, primes are about 1024 bits long. The number of such primes is astronomically huge (≈ $2^{1024}/\ln(2^{1024})$). Storing them is physically impossible.
2. **Storage problem**: Even if each prime is 128 bytes, storing all 1024-bit primes would require more storage than the atoms in the universe.
3. **Search time**: Even with a database, searching for the right two factors would take impractical time.

**Conclusion:** A prime database cannot realistically exist for such large primes. Hence RSA remains secure in practice.

---

## Q3(b) How is S-box substitution used to convert a 48-bit input to 32-bit output? Discuss with necessary figure and data.

**In DES:**

* Each round of DES uses a substitution step with **8 S-boxes**.
* Input: 48 bits (from the expansion of 32-bit R block + round key XOR).
* Process:

  1. The 48 bits are divided into **8 groups of 6 bits each**.
  2. Each group is input into a different **S-box**.
  3. Each S-box maps **6-bit input → 4-bit output** using a predefined substitution table.
  4. Thus, 8 S-boxes × 4 bits = **32-bit output**.

**How mapping works:**

* For each 6-bit block:

  * The **first and last bit** (2 bits) indicate the row number.
  * The **middle 4 bits** indicate the column number.
  * The entry at that row & column in the S-box table gives a **4-bit output**.

**Example:**

* Suppose input block = `101011`.

  * Row = `11` (binary = 3).
  * Column = `0101` (binary = 5).
  * Look up S-box\[3]\[5] → gives 4-bit output.
* Repeat for all 8 blocks.

**Figure (conceptual):**

```
48-bit input → Split into 8 groups (6 bits each)
   ↓
S1   S2   S3   S4   S5   S6   S7   S8
   ↓    ↓    ↓    ↓    ↓    ↓    ↓    ↓
  4b   4b   4b   4b   4b   4b   4b   4b → 32-bit output
```

---

## Q3(c) Briefly discuss the variants of DES.

1. **DES (Data Encryption Standard):**

   * 56-bit key, 16 rounds.
   * Now considered insecure due to brute-force attacks.

2. **Double DES (2DES):**

   * Apply DES twice with two different keys.
   * Key length: 112 bits.
   * Vulnerable to **Meet-in-the-Middle attack** (effective strength \~57 bits).

3. **Triple DES (3DES):**

   * Apply DES three times with either 2 keys (112-bit security) or 3 keys (168-bit security).
   * More secure, widely used in finance.
   * Slower than AES.

4. **AES (as replacement):**

   * Not a DES variant but its successor.
   * Supports 128/192/256-bit keys, much stronger than DES.

**Summary:**

* Original DES is broken.
* 2DES is weak due to attacks.
* 3DES is secure but slow.
* AES replaced DES in modern cryptography.
