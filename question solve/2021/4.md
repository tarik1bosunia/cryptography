## Question 4 Answers

### (a) DES S‑box substitution and P‑box permutation (with example)

**S‑box substitution (DES f‑function):**
After the right half (32 bits) is expanded to 48 bits and XORed with the round key, the 48 bits are split into eight 6‑bit chunks. Each 6‑bit chunk enters one **S‑box** (S1…S8). An S‑box maps 6 input bits → 4 output bits using a fixed lookup table.

**How lookup works (for any S‑box):**

* Row = binary formed by the **1st and 6th** bits.
* Column = binary formed by the **middle 4** bits (bits 2–5).
* Output = table[row][column] (a 4‑bit value).

**Concrete example using S1:**
S1 row 1..4 (decimal values):

* r1: 14 4 13 1 2 15 11 8 3 10 6 12 5 9 0 7
* r2: 0 15 7 4 14 2 13 1 10 6 12 11 9 5 3 8
* r3: 4 1 14 8 13 6 2 11 15 12 9 7 3 10 5 0
* r4: 15 12 8 2 4 9 1 7 5 11 3 14 10 0 6 13

Take 6‑bit input **011011**:
Row = b1b6 = **01** → row **1** (2nd row).
Column = b2..b5 = **1101** → column **13**.
Lookup S1[1][13] = **5** → output **0101** (4 bits).

All eight S‑boxes produce 32 bits total.

**P‑box permutation:**
DES then permutes these 32 bits by a fixed **P** table (rearrangement only, no substitution).
P table (bit positions):

```
16  7 20 21   29 12 28 17   1 15 23 26   5 18 31 10
 2  8 24 14   32 27  3  9  19 13 30  6  22 11  4 25
```

Meaning: output bit1 = input bit16, output bit2 = input bit7, …

**Mini example:** if the S‑box output bits are Y₁…Y₃₂ and Y₁₆=1, Y₇=0, Y₂₀=1, Y₂₁=1, then the P‑box’s first four output bits become 1,0,1,1 respectively. (It’s just a re‑ordering.)

---

### (b) RSA decryption key when p=5, q=7, e=11

* **n = p·q = 5×7 = 35**
* **ϕ(n) = (p−1)(q−1) = 4×6 = 24**
* Find **d** such that **e·d ≡ 1 (mod 24)**.
  Inverse of 11 mod 24 is **11** (since 11×11=121 ≡ 1 mod 24).
* **Decryption key:** `d = 11`
* **Private key:** `(n,d) = (35, 11)`

---

### (c) Lehmann’s probabilistic primality test

**Idea:** Based on Euler’s criterion. For odd n>2, pick random **a** with 1<a<n−1 and compute
`r = a^{(n−1)/2} mod n`.

* If `r ≠ 1` and `r ≠ n−1 (≡ −1 mod n)`, then **n is composite**.
* If `r ∈ {1, n−1}`, then **n is a probable prime** for base a.
* Repeat with k independent random a’s; if n passes all, declare “probably prime” with error ≤ (1/2)^k.

**Examples:**

* n=7, a=3: `3^{3} mod 7 = 27 mod 7 = 6 = −1` → passes (probably prime).
* n=9, a=2: `2^{4} mod 9 = 16 mod 9 = 7` (neither 1 nor 8) → composite.

**Notes:** Faster than trial division; error can be made arbitrarily small by increasing k, but unlike deterministic tests it never proves primality with certainty.
