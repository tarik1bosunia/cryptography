## Question 5 Answers

### (a) Kerberos Authentication Procedure

**Kerberos** is a trusted third-party authentication protocol designed for **TCP/IP networks**. It uses symmetric key cryptography and a trusted **Key Distribution Center (KDC)** consisting of two components:

* **Authentication Server (AS)**
* **Ticket Granting Server (TGS)**

#### (i) Procedure to get Initial Ticket (TGT – Ticket Granting Ticket)

1. **Client → AS:** The user logs in and sends a request to the Authentication Server with their ID and the ID of the TGS.

   * Message: `IDc || IDtgs || TS1`
2. **AS → Client:** The AS verifies the client’s credentials and sends back:

   * Encrypted message with client’s secret key (derived from password):
     `E(Kc, [Kc,tgs || IDtgs || TS2 || Lifetime || Ticket_tgs])`
   * The Ticket Granting Ticket (TGT):
     `E(Ktgs, [IDc || ADc || Kc,tgs || Lifetime])`
3. **Result:** The client decrypts the AS message and obtains `Kc,tgs`, a session key for communication with TGS.

#### (ii) Procedure to get a Service Ticket

1. **Client → TGS:** The client requests access to a specific service.

   * Sends: `IDv || Ticket_tgs || Authenticator_c`
   * Authenticator_c = `E(Kc,tgs, [IDc || ADc || TS3])`
2. **TGS → Client:** The TGS verifies the TGT and Authenticator, then issues a **Service Ticket**.

   * `E(Kv, [IDc || ADc || Kc,v || Lifetime])`
   * Sent with a copy encrypted for the client: `E(Kc,tgs, [Kc,v || IDv || TS4])`
3. **Client → Server (V):** The client sends `Ticket_v || Authenticator_c` to the service server.
4. **Server → Client:** The server may reply with a confirmation timestamp, proving mutual authentication.

**Result:** The client is now authenticated and can securely access the requested service.

---

### (b) Key Distribution and Public-Key Certificate Technique

**Key Distribution:**
It refers to the secure process of delivering cryptographic keys between communicating parties. Since keys must remain secret, their distribution must be protected from interception and tampering.

**Techniques:**

1. **Manual Distribution:** Physically handing keys between parties (secure but impractical).
2. **Automatic Distribution via KDC:** A trusted server distributes keys securely (like in Kerberos).
3. **Public-Key Certificates:** Used in asymmetric cryptography for scalable and secure distribution.

**Public-Key Certificate Technique:**

* A **Certificate Authority (CA)** issues digital certificates that bind a user’s **identity** with their **public key**.
* The certificate contains:
  `User ID, Public Key, Validity Period, CA Signature`.
* When a user receives a public key, they verify the CA’s digital signature using the CA’s known public key.
* Ensures authenticity of the key and prevents man-in-the-middle attacks.

**Example:**
If Alice wants Bob’s public key, she gets Bob’s certificate from the CA. After verifying the CA’s signature, she can trust that the included public key truly belongs to Bob.
